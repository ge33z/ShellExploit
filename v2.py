import requests
import os
import socket
from colorama import init, Fore
from multiprocessing.dummy import Pool
import warnings
from requests.packages.urllib3.exceptions import InsecureRequestWarning

warnings.simplefilter('ignore', InsecureRequestWarning)
init(autoreset=True)

def check_vulnerability(url):
    try:
        headers = {'User-Agent': 'Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:28.0) Gecko/20100101 Firefox/72.0'}
        with open("web.txt", 'r') as file:
            lines = file.read().splitlines()

        for line in lines:
            response = requests.get(url + line, headers=headers, timeout=5)
            content = response.content.decode('utf-8')  # Decode bytes to string

            if '-rw-r--r' in content or 'drwxr-xr-x' in response.text:
                print(url + Fore.GREEN + ' ' + 'Vuln' + Fore.WHITE)
                with open('shell.txt', 'a') as vuln_file:
                    vuln_file.write(url + line + "\n")
            elif '<input type=file' in response.text or 'option value="chmod">' in content:
                with open('shell.txt', 'a') as shell_file:
                    shell_file.write(url + line + "\n")
            else:
                print(url + Fore.RED + ' ' + 'Not Vuln' + Fore.WHITE)
                with open('web.txt', 'a') as non_vuln_file:
                    non_vuln_file.write(url + "\n")

    except Exception as e:
        print(f"An error occurred for {url}: {e}")


def main():
    try:
        list_file = input("\n\033[91mlist\033[97m:~# \033[97m")
        domains = open(list_file, 'r').read().splitlines()
        pool = Pool(50)
        pool.map(check_vulnerability, domains)
        pool.close()
        pool.join()
    except Exception as e:
        print(f"An error occurred: {e}")


if __name__ == '__main__':
    main()
    input()
